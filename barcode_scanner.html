Quagga.init({
    inputStream: {
        name: "Live",
        type: "LiveStream",
        target: document.querySelector('#interactive'),
        constraints: {
            facingMode: "environment", // 背面カメラを使用
            width: { ideal: 1280 }, // 解像度を下げる（理想値）
            height: { ideal: 720 }
        },
        area: { // カメラの処理領域を指定
            top: "0%",
            right: "0%",
            bottom: "0%",
            left: "0%"
        },
        singleChannel: false // カラーモードを使用
    },
    decoder: {
        readers: ["code_128_reader"], // 必要なバーコードリーダーのみを指定
        multiple: false // 複数バーコードの同時読み取りを無効化
    },
    locate: true, // バーコードの位置を特定
    numOfWorkers: navigator.hardwareConcurrency || 4, // 利用可能なCPUコア数に基づくワーカー数
    frequency: 10, // フレームの処理頻度（Hz）
    debug: false // デバッグ情報を無効化
}, function(err) {
    if (err) {
        console.error(err);
        alert("バーコードスキャナーの初期化に失敗しました。");
        return;
    }
    Quagga.start();
    isScanning = true;
    document.getElementById('scanButton').textContent = "スキャン停止";
});
